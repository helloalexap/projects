# Vercel部署指南 - 数据分析处理器

本文档提供了在Vercel上部署数据分析处理器的详细步骤指引。

## 准备工作

在开始部署之前，请确保您已经：

1. 注册了Vercel账户并完成登录
2. 已经下载了数据分析处理器的完整代码
3. 确认项目中包含了所有必要的配置文件，特别是`vercel.json`

## 详细部署步骤

### 1. 准备本地项目

首先，确保您的项目结构正确，并包含所有必要的文件：

- `app.py` - 主应用程序文件
- `wsgi.py` - WSGI入口文件
- `requirements.txt` - 依赖列表
- `vercel.json` - Vercel配置文件
- `modules/` - 包含所有功能模块
- `templates/` - 包含HTML模板
- `static/` - 包含静态文件

### 2. 安装Vercel CLI

如果您想使用命令行部署，需要安装Vercel CLI：

```bash
npm install -g vercel
```

### 3. 部署方法一：使用Vercel CLI

1. 打开命令行终端
2. 导航到项目根目录：
   ```bash
   cd path/to/data_analyzer
   ```
3. 登录Vercel（如果尚未登录）：
   ```bash
   vercel login
   ```
4. 执行部署命令：
   ```bash
   vercel
   ```
5. 按照提示回答问题：
   - 是否要设置并部署项目？选择 `Y`
   - 要链接到现有项目还是创建新项目？选择 `N` 创建新项目
   - 项目名称：输入您想要的名称，如 `data-analyzer`
   - 项目根目录：直接按回车键使用当前目录
   - 是否要覆盖配置？选择 `N`（因为我们已经有了`vercel.json`）
   - 要部署到哪个范围？选择您的个人账户或团队
   - 是否要修改这些设置？选择 `N`

部署过程将开始，完成后会显示部署URL。

### 4. 部署方法二：使用Vercel网页界面

1. 将您的项目上传到GitHub、GitLab或Bitbucket
   - 如果您还没有将项目上传到Git仓库，请先创建一个仓库并推送代码
   - 确保包含所有必要的文件，特别是`vercel.json`

2. 登录Vercel网站 (https://vercel.com)

3. 点击"New Project"按钮

4. 从列表中选择您的Git仓库
   - 如果看不到您的仓库，可能需要导入或授权访问

5. 配置项目：
   - 项目名称：保持默认或自定义
   - 框架预设：选择"Other"
   - 根目录：保持默认（通常是`/`）
   - 构建命令：留空（由`vercel.json`控制）
   - 输出目录：留空（由`vercel.json`控制）
   - 环境变量：添加`FLASK_ENV=production`

6. 点击"Deploy"按钮开始部署

部署过程将开始，完成后会显示部署URL。

### 5. 验证部署

1. 部署完成后，Vercel会提供一个URL（通常是`https://your-project-name.vercel.app`）
2. 在浏览器中访问该URL，确认应用程序已成功部署
3. 测试以下功能：
   - 首页加载
   - 静态资源（CSS、JavaScript）加载
   - 各功能页面（处理、可视化、导出）访问

### 6. 配置自定义域名（可选）

如果您有自己的域名，可以将其连接到Vercel项目：

1. 在Vercel仪表板中，选择您的项目
2. 点击"Settings"选项卡
3. 在左侧菜单中选择"Domains"
4. 点击"Add"按钮
5. 输入您的域名（例如`www.yourdomain.com`）
6. 按照提示配置DNS记录：
   - 如果您想使用Vercel的DNS服务，选择"Vercel DNS"并按照说明添加域名服务器
   - 如果您想使用现有的DNS提供商，选择"External DNS"并按照说明添加DNS记录

Vercel会自动为您的域名配置SSL证书。

### 7. 配置环境变量（如需要）

如果您的应用需要环境变量：

1. 在Vercel仪表板中，选择您的项目
2. 点击"Settings"选项卡
3. 在左侧菜单中选择"Environment Variables"
4. 添加所需的环境变量，例如：
   - `FLASK_ENV=production`
   - 其他应用特定的环境变量

### 8. 设置存储解决方案

由于Vercel的无服务器环境不支持持久化文件存储，您需要配置云存储服务来存储用户上传的文件和生成的报告：

1. 创建AWS S3或Google Cloud Storage账户
2. 创建存储桶
3. 获取访问凭证
4. 在Vercel中添加相应的环境变量
5. 修改应用程序代码以使用云存储（如需要）

### 9. 持续部署

Vercel支持持续部署，每次您推送代码到Git仓库时，都会自动部署：

1. 对代码进行更改
2. 提交并推送到Git仓库
3. Vercel会自动检测更改并重新部署
4. 在Vercel仪表板中查看部署状态和历史

### 10. 故障排除

如果部署过程中遇到问题：

1. 检查Vercel部署日志：
   - 在项目仪表板中点击最新部署
   - 查看"Build Logs"和"Runtime Logs"

2. 常见问题及解决方案：
   - 依赖安装失败：检查`requirements.txt`文件是否正确
   - 构建错误：检查`vercel.json`配置是否正确
   - 运行时错误：检查应用程序代码和日志

3. 如果看到"Internal Server Error"：
   - 检查应用程序日志
   - 确保应用程序配置适合无服务器环境
   - 确保所有依赖都已正确安装

## 注意事项

1. **文件存储限制**：Vercel的无服务器环境不支持本地文件系统的持久化存储。用户上传的文件和生成的报告需要存储在云存储服务（如AWS S3或Google Cloud Storage）中。

2. **冷启动时间**：无服务器函数在一段时间不活动后会进入休眠状态，首次访问可能会有轻微延迟。

3. **执行时间限制**：Vercel的函数执行时间有限制，长时间运行的操作可能会超时。

4. **内存限制**：Vercel的函数有内存限制，处理大型数据集可能会遇到问题。

## 结论

按照上述步骤，您应该能够成功将数据分析处理器部署到Vercel平台。部署完成后，您的应用程序将可以通过Vercel提供的URL或您配置的自定义域名访问。

如果您在部署过程中遇到任何问题，请参考Vercel的官方文档或联系Vercel支持团队。
